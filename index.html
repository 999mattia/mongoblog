<!DOCTYPE html>
<html>
	<head>
		<title>Mongoblog</title>
	</head>
	<body>
		<h1>Posts</h1>
		<div id="posts-container"></div>

		<script>
			// Function to fetch all posts
			async function fetchPosts() {
				try {
					const response = await fetch("/api/posts");
					const posts = await response.json();

					const postsContainer =
						document.getElementById("posts-container");
					postsContainer.innerHTML = "";

					posts.forEach((post) => {
						const postDiv = document.createElement("div");
						postDiv.classList.add("post");

						const title = document.createElement("h2");
						title.textContent = post.title;

						const content = document.createElement("p");
						content.textContent = post.content;

						const author = document.createElement("p");
						content.textContent = post.author;

						// const deleteButton = document.createElement("button");
						// deleteButton.textContent = "Delete";
						// deleteButton.addEventListener("click", () =>
						// 	deletePost(post.id)
						// );

						postDiv.appendChild(title);
						postDiv.appendChild(content);
						// postDiv.appendChild(deleteButton);

						const comments = document.createElement("div");

						post.comments.forEach((comment) => {
							const commentDiv = document.createElement("div");
							commentDiv.classList.add("comment");

							const commentAuthor = document.createElement("p");
							commentAuthor.textContent = comment.author;

							const commentText = document.createElement("p");
							commentText.textContent = comment.text;

							commentDiv.appendChild(commentAuthor);
							commentDiv.appendChild(commentText);

							comments.appendChild(commentDiv);
						});

						postDiv.appendChild(comments);

						postsContainer.appendChild(postDiv);
					});
				} catch (error) {
					console.error("Error:", error);
				}
			}

			// async function deletePost(postId) {
			// 	try {
			// 		const response = await fetch(
			// 			`https://example.com/posts/${postId}`,
			// 			{
			// 				method: "DELETE",
			// 			}
			// 		);
			// 		const result = await response.json();
			// 		console.log("Post deleted:", result);
			// 		fetchPosts();
			// 	} catch (error) {
			// 		console.error("Error:", error);
			// 	}
			// }

			fetchPosts();
		</script>
	</body>
</html>
